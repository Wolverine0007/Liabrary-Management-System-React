{"ast":null,"code":"var _jsxFileName = \"/Users/sanketbanate/Desktop/Project/Library-Management-System/frontend/src/components/Issue/Issue.js\";\nimport React from 'react';\nimport axios from 'axios';\nimport config from '../../config';\nimport './Issue.css';\n\nclass Issue extends React.Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      books: [],\n      students: [],\n      selectedStudentId: '',\n      selectedStudentName: '',\n      searchQuery: '',\n      studentSearchQuery: '',\n      filteredStudents: [],\n      showStudentDropdown: false,\n      loading: false\n    };\n\n    this.fetchBooks = () => {\n      axios.get(`${config.API_BASE_URL}/api/getBooks`).then(response => {\n        this.setState({\n          books: response.data.filter(book => book.book_count > 0)\n        });\n      }).catch(error => {\n        console.error('Error fetching books:', error);\n      });\n    };\n\n    this.fetchStudents = () => {\n      axios.get(`${config.API_BASE_URL}/api/getStudents`).then(response => {\n        this.setState({\n          students: response.data,\n          filteredStudents: response.data\n        });\n      }).catch(error => {\n        console.error('Error fetching students:', error);\n      });\n    };\n\n    this.searchBooks = () => {\n      if (!this.state.searchQuery.trim()) {\n        this.fetchBooks();\n        return;\n      }\n\n      axios.get(`${config.API_BASE_URL}/api/searchBooks/${this.state.searchQuery}`).then(response => {\n        this.setState({\n          books: response.data.filter(book => book.book_count > 0)\n        });\n      }).catch(error => {\n        console.error('Error searching books:', error);\n      });\n    };\n\n    this.issueBook = book => {\n      if (!this.state.selectedStudentId) {\n        alert('Please select a student first');\n        return;\n      }\n\n      axios.post(`${config.API_BASE_URL}/api/borrow`, {\n        id: book.id,\n        sid: this.state.selectedStudentId\n      }).then(response => {\n        alert(`Book \"${book.name}\" issued to ${this.state.selectedStudentName}`);\n        this.fetchBooks();\n      }).catch(error => {\n        console.error('Error issuing book:', error);\n        alert('Failed to issue book');\n      });\n    };\n\n    this.selectStudent = student => {\n      this.setState({\n        selectedStudentId: student.id,\n        selectedStudentName: student.name,\n        studentSearchQuery: '',\n        showStudentDropdown: false\n      });\n    };\n\n    this.searchStudents = query => {\n      const filtered = this.state.students.filter(student => student.name.toLowerCase().includes(query.toLowerCase()) || student.id.toString().includes(query));\n      this.setState({\n        filteredStudents: filtered,\n        showStudentDropdown: query.length > 0 && filtered.length > 0\n      });\n    };\n  }\n\n  componentDidMount() {\n    this.fetchBooks();\n    this.fetchStudents();\n  }\n\n  render() {\n    return React.createElement(\"div\", {\n      id: \"issue\",\n      className: \"text-center\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 102\n      },\n      __self: this\n    }, React.createElement(\"h2\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 103\n      },\n      __self: this\n    }, \"Issue Books\"), React.createElement(\"div\", {\n      className: \"student-selection\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 105\n      },\n      __self: this\n    }, React.createElement(\"h3\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 106\n      },\n      __self: this\n    }, \"Select Student\"), this.state.selectedStudentId ? React.createElement(\"div\", {\n      className: \"selected-student\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 108\n      },\n      __self: this\n    }, React.createElement(\"p\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 109\n      },\n      __self: this\n    }, \"Selected: \", React.createElement(\"strong\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 109\n      },\n      __self: this\n    }, this.state.selectedStudentName), \" (ID: \", this.state.selectedStudentId, \")\"), React.createElement(\"button\", {\n      onClick: () => this.setState({\n        selectedStudentId: '',\n        selectedStudentName: '',\n        studentSearchQuery: ''\n      }),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 110\n      },\n      __self: this\n    }, \"Change Student\")) : React.createElement(\"div\", {\n      className: \"student-search-container\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 113\n      },\n      __self: this\n    }, React.createElement(\"input\", {\n      type: \"text\",\n      placeholder: \"Search student by name or ID...\",\n      value: this.state.studentSearchQuery,\n      onChange: e => {\n        this.setState({\n          studentSearchQuery: e.target.value\n        });\n        this.searchStudents(e.target.value);\n      },\n      onFocus: () => this.setState({\n        showStudentDropdown: this.state.filteredStudents.length > 0\n      }),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 114\n      },\n      __self: this\n    }), this.state.showStudentDropdown && React.createElement(\"div\", {\n      className: \"student-dropdown\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 125\n      },\n      __self: this\n    }, this.state.filteredStudents.slice(0, 10).map(student => React.createElement(\"div\", {\n      key: student.id,\n      className: \"student-option\",\n      onClick: () => this.selectStudent(student),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 127\n      },\n      __self: this\n    }, React.createElement(\"span\", {\n      className: \"student-name\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 132\n      },\n      __self: this\n    }, student.name), React.createElement(\"span\", {\n      className: \"student-id\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 133\n      },\n      __self: this\n    }, \"ID: \", student.id)))))), React.createElement(\"div\", {\n      className: \"book-search\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 142\n      },\n      __self: this\n    }, React.createElement(\"h3\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 143\n      },\n      __self: this\n    }, \"Search Books\"), React.createElement(\"div\", {\n      className: \"search-bar\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 144\n      },\n      __self: this\n    }, React.createElement(\"input\", {\n      type: \"text\",\n      placeholder: \"Search books by name or author...\",\n      value: this.state.searchQuery,\n      onChange: e => this.setState({\n        searchQuery: e.target.value\n      }),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 145\n      },\n      __self: this\n    }), React.createElement(\"button\", {\n      onClick: this.searchBooks,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 151\n      },\n      __self: this\n    }, \"Search\"), React.createElement(\"button\", {\n      onClick: () => {\n        this.setState({\n          searchQuery: ''\n        });\n        this.fetchBooks();\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 152\n      },\n      __self: this\n    }, \"Clear\"))), React.createElement(\"table\", {\n      id: \"results\",\n      className: \"table table-hover\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 156\n      },\n      __self: this\n    }, React.createElement(\"thead\", {\n      id: \"header\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 157\n      },\n      __self: this\n    }, React.createElement(\"tr\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 158\n      },\n      __self: this\n    }, React.createElement(\"th\", {\n      scope: \"col\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 159\n      },\n      __self: this\n    }, \"Book ID\"), React.createElement(\"th\", {\n      scope: \"col\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 160\n      },\n      __self: this\n    }, \"Book Name\"), React.createElement(\"th\", {\n      scope: \"col\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 161\n      },\n      __self: this\n    }, \"Author\"), React.createElement(\"th\", {\n      scope: \"col\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 162\n      },\n      __self: this\n    }, \"Available\"), React.createElement(\"th\", {\n      scope: \"col\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 163\n      },\n      __self: this\n    }, \"Action\"))), React.createElement(\"tbody\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 166\n      },\n      __self: this\n    }, this.state.books.map(book => React.createElement(\"tr\", {\n      key: book.id,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 168\n      },\n      __self: this\n    }, React.createElement(\"td\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 169\n      },\n      __self: this\n    }, book.id), React.createElement(\"td\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 170\n      },\n      __self: this\n    }, book.name.toUpperCase()), React.createElement(\"td\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 171\n      },\n      __self: this\n    }, book.author), React.createElement(\"td\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 172\n      },\n      __self: this\n    }, book.book_count), React.createElement(\"td\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 173\n      },\n      __self: this\n    }, React.createElement(\"button\", {\n      className: \"btn btn-primary\",\n      onClick: () => this.issueBook(book),\n      disabled: !this.state.selectedStudentId || book.book_count === 0,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 174\n      },\n      __self: this\n    }, \"Issue\")))))));\n  }\n\n}\n\nexport default Issue;","map":{"version":3,"sources":["/Users/sanketbanate/Desktop/Project/Library-Management-System/frontend/src/components/Issue/Issue.js"],"names":["React","axios","config","Issue","Component","state","books","students","selectedStudentId","selectedStudentName","searchQuery","studentSearchQuery","filteredStudents","showStudentDropdown","loading","fetchBooks","get","API_BASE_URL","then","response","setState","data","filter","book","book_count","catch","error","console","fetchStudents","searchBooks","trim","issueBook","alert","post","id","sid","name","selectStudent","student","searchStudents","query","filtered","toLowerCase","includes","toString","length","componentDidMount","render","e","target","value","slice","map","toUpperCase","author"],"mappings":"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","sourcesContent":["import React from 'react';\r\nimport axios from 'axios';\r\nimport config from '../../config';\r\nimport './Issue.css';\r\n\r\nclass Issue extends React.Component {\r\n    \r\n    state = {\r\n        books: [],\r\n        students: [],\r\n        selectedStudentId: '',\r\n        selectedStudentName: '',\r\n        searchQuery: '',\r\n        studentSearchQuery: '',\r\n        filteredStudents: [],\r\n        showStudentDropdown: false,\r\n        loading: false\r\n    };\r\n\r\n    componentDidMount() {\r\n        this.fetchBooks();\r\n        this.fetchStudents();\r\n    }\r\n\r\n    fetchBooks = () => {\r\n        axios.get(`${config.API_BASE_URL}/api/getBooks`)\r\n            .then(response => {\r\n                this.setState({ books: response.data.filter(book => book.book_count > 0) });\r\n            })\r\n            .catch(error => {\r\n                console.error('Error fetching books:', error);\r\n            });\r\n    }\r\n\r\n    fetchStudents = () => {\r\n        axios.get(`${config.API_BASE_URL}/api/getStudents`)\r\n            .then(response => {\r\n                this.setState({ students: response.data, filteredStudents: response.data });\r\n            })\r\n            .catch(error => {\r\n                console.error('Error fetching students:', error);\r\n            });\r\n    }\r\n\r\n    searchBooks = () => {\r\n        if (!this.state.searchQuery.trim()) {\r\n            this.fetchBooks();\r\n            return;\r\n        }\r\n\r\n        axios.get(`${config.API_BASE_URL}/api/searchBooks/${this.state.searchQuery}`)\r\n            .then(response => {\r\n                this.setState({ books: response.data.filter(book => book.book_count > 0) });\r\n            })\r\n            .catch(error => {\r\n                console.error('Error searching books:', error);\r\n            });\r\n    }\r\n\r\n    issueBook = (book) => {\r\n        if (!this.state.selectedStudentId) {\r\n            alert('Please select a student first');\r\n            return;\r\n        }\r\n\r\n        axios.post(`${config.API_BASE_URL}/api/borrow`, {\r\n            id: book.id,\r\n            sid: this.state.selectedStudentId\r\n        })\r\n        .then(response => {\r\n            alert(`Book \"${book.name}\" issued to ${this.state.selectedStudentName}`);\r\n            this.fetchBooks();\r\n        })\r\n        .catch(error => {\r\n            console.error('Error issuing book:', error);\r\n            alert('Failed to issue book');\r\n        });\r\n    }\r\n\r\n    selectStudent = (student) => {\r\n        this.setState({\r\n            selectedStudentId: student.id,\r\n            selectedStudentName: student.name,\r\n            studentSearchQuery: '',\r\n            showStudentDropdown: false\r\n        });\r\n    }\r\n\r\n    searchStudents = (query) => {\r\n        const filtered = this.state.students.filter(student => \r\n            student.name.toLowerCase().includes(query.toLowerCase()) ||\r\n            student.id.toString().includes(query)\r\n        );\r\n        this.setState({ \r\n            filteredStudents: filtered,\r\n            showStudentDropdown: query.length > 0 && filtered.length > 0\r\n        });\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <div id='issue' className=\"text-center\">\r\n                <h2>Issue Books</h2>\r\n                \r\n                <div className=\"student-selection\">\r\n                    <h3>Select Student</h3>\r\n                    {this.state.selectedStudentId ? (\r\n                        <div className=\"selected-student\">\r\n                            <p>Selected: <strong>{this.state.selectedStudentName}</strong> (ID: {this.state.selectedStudentId})</p>\r\n                            <button onClick={() => this.setState({ selectedStudentId: '', selectedStudentName: '', studentSearchQuery: '' })}>Change Student</button>\r\n                        </div>\r\n                    ) : (\r\n                        <div className=\"student-search-container\">\r\n                            <input\r\n                                type=\"text\"\r\n                                placeholder=\"Search student by name or ID...\"\r\n                                value={this.state.studentSearchQuery}\r\n                                onChange={(e) => {\r\n                                    this.setState({ studentSearchQuery: e.target.value });\r\n                                    this.searchStudents(e.target.value);\r\n                                }}\r\n                                onFocus={() => this.setState({ showStudentDropdown: this.state.filteredStudents.length > 0 })}\r\n                            />\r\n                            {this.state.showStudentDropdown && (\r\n                                <div className=\"student-dropdown\">\r\n                                    {this.state.filteredStudents.slice(0, 10).map(student => (\r\n                                        <div \r\n                                            key={student.id} \r\n                                            className=\"student-option\"\r\n                                            onClick={() => this.selectStudent(student)}\r\n                                        >\r\n                                            <span className=\"student-name\">{student.name}</span>\r\n                                            <span className=\"student-id\">ID: {student.id}</span>\r\n                                        </div>\r\n                                    ))}\r\n                                </div>\r\n                            )}\r\n                        </div>\r\n                    )}\r\n                </div>\r\n\r\n                <div className=\"book-search\">\r\n                    <h3>Search Books</h3>\r\n                    <div className=\"search-bar\">\r\n                        <input\r\n                            type=\"text\"\r\n                            placeholder=\"Search books by name or author...\"\r\n                            value={this.state.searchQuery}\r\n                            onChange={(e) => this.setState({ searchQuery: e.target.value })}\r\n                        />\r\n                        <button onClick={this.searchBooks}>Search</button>\r\n                        <button onClick={() => { this.setState({ searchQuery: '' }); this.fetchBooks(); }}>Clear</button>\r\n                    </div>\r\n                </div>\r\n\r\n                <table id=\"results\" className=\"table table-hover\">\r\n                    <thead id=\"header\">\r\n                        <tr>\r\n                            <th scope=\"col\">Book ID</th>\r\n                            <th scope=\"col\">Book Name</th>\r\n                            <th scope=\"col\">Author</th>\r\n                            <th scope=\"col\">Available</th>\r\n                            <th scope=\"col\">Action</th>\r\n                        </tr>\r\n                    </thead>\r\n                    <tbody>\r\n                        {this.state.books.map(book => (\r\n                            <tr key={book.id}>\r\n                                <td>{book.id}</td>\r\n                                <td>{book.name.toUpperCase()}</td>\r\n                                <td>{book.author}</td>\r\n                                <td>{book.book_count}</td>\r\n                                <td>\r\n                                    <button \r\n                                        className=\"btn btn-primary\" \r\n                                        onClick={() => this.issueBook(book)}\r\n                                        disabled={!this.state.selectedStudentId || book.book_count === 0}\r\n                                    >\r\n                                        Issue\r\n                                    </button>\r\n                                </td>\r\n                            </tr>\r\n                        ))}\r\n                    </tbody>\r\n                </table>\r\n            </div>\r\n        );\r\n    }\r\n\r\n}\r\n\r\nexport default Issue;"]},"metadata":{},"sourceType":"module"}