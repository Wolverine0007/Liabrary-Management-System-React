{"ast":null,"code":"import _slicedToArray from\"/Users/sanketbanate/Desktop/Project/Library-Management-System/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _classCallCheck from\"/Users/sanketbanate/Desktop/Project/Library-Management-System/frontend/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/sanketbanate/Desktop/Project/Library-Management-System/frontend/node_modules/@babel/runtime/helpers/esm/createClass\";import _possibleConstructorReturn from\"/Users/sanketbanate/Desktop/Project/Library-Management-System/frontend/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"/Users/sanketbanate/Desktop/Project/Library-Management-System/frontend/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";import _inherits from\"/Users/sanketbanate/Desktop/Project/Library-Management-System/frontend/node_modules/@babel/runtime/helpers/esm/inherits\";import React,{Component}from'react';import axios from'axios';import'./FineManagement.css';var FineManagement=/*#__PURE__*/function(_Component){_inherits(FineManagement,_Component);function FineManagement(props){var _this;_classCallCheck(this,FineManagement);_this=_possibleConstructorReturn(this,_getPrototypeOf(FineManagement).call(this,props));_this.fetchFineData=function(){_this.setState({loading:true});Promise.all([axios.get('/api/studentsWithFines'),axios.get('/api/overdueBooks')]).then(function(_ref){var _ref2=_slicedToArray(_ref,2),finesRes=_ref2[0],overdueRes=_ref2[1];_this.setState({studentsWithFines:finesRes.data,overdueBooks:overdueRes.data,loading:false});}).catch(function(error){console.error('Error fetching fine data:',error);_this.setState({loading:false});});};_this.payFine=function(studentId,studentName,currentFine){var amount=parseFloat(_this.state.paymentAmount);if(!amount||amount<=0||amount>currentFine){alert('Please enter a valid payment amount');return;}if(window.confirm(\"Process payment of \\u20B9\".concat(amount,\" for \").concat(studentName,\"?\"))){axios.post('/api/payFine',{studentId:studentId,amount:amount}).then(function(response){alert('Payment processed successfully!');_this.setState({paymentAmount:'',selectedStudent:null});_this.fetchFineData();}).catch(function(error){console.error('Error processing payment:',error);alert('Failed to process payment');});}};_this.state={studentsWithFines:[],overdueBooks:[],paymentAmount:'',selectedStudent:null,loading:false};return _this;}_createClass(FineManagement,[{key:\"componentDidMount\",value:function componentDidMount(){this.fetchFineData();}},{key:\"render\",value:function render(){var _this2=this;var _this$state=this.state,studentsWithFines=_this$state.studentsWithFines,overdueBooks=_this$state.overdueBooks,paymentAmount=_this$state.paymentAmount,selectedStudent=_this$state.selectedStudent,loading=_this$state.loading;return React.createElement(\"div\",{className:\"fine-management\"},React.createElement(\"h2\",null,\"Fine Management\"),loading&&React.createElement(\"div\",{className:\"loading\"},\"Loading...\"),React.createElement(\"div\",{className:\"fine-sections\"},React.createElement(\"div\",{className:\"section\"},React.createElement(\"h3\",null,\"Students with Outstanding Fines\"),studentsWithFines.length===0?React.createElement(\"p\",{className:\"no-data\"},\"No outstanding fines\"):React.createElement(\"table\",null,React.createElement(\"thead\",null,React.createElement(\"tr\",null,React.createElement(\"th\",null,\"Student ID\"),React.createElement(\"th\",null,\"Student Name\"),React.createElement(\"th\",null,\"Fine Amount\"),React.createElement(\"th\",null,\"Actions\"))),React.createElement(\"tbody\",null,studentsWithFines.map(function(student){return React.createElement(\"tr\",{key:student.id},React.createElement(\"td\",null,student.id),React.createElement(\"td\",null,student.name),React.createElement(\"td\",{className:\"fine-amount\"},\"\\u20B9\",(parseFloat(student.fine)||0).toFixed(2)),React.createElement(\"td\",null,React.createElement(\"button\",{className:\"pay-btn\",onClick:function onClick(){return _this2.setState({selectedStudent:student,paymentAmount:(parseFloat(student.fine)||0).toString()});}},\"Pay Fine\")));})))),React.createElement(\"div\",{className:\"section\"},React.createElement(\"h3\",null,\"Overdue Books (Generating Fines)\"),overdueBooks.length===0?React.createElement(\"p\",{className:\"no-data\"},\"No overdue books\"):React.createElement(\"table\",null,React.createElement(\"thead\",null,React.createElement(\"tr\",null,React.createElement(\"th\",null,\"Student\"),React.createElement(\"th\",null,\"Book\"),React.createElement(\"th\",null,\"Days Overdue\"),React.createElement(\"th\",null,\"Potential Fine\"),React.createElement(\"th\",null,\"Deadline\"))),React.createElement(\"tbody\",null,overdueBooks.map(function(book,index){return React.createElement(\"tr\",{key:index},React.createElement(\"td\",null,book.studentName),React.createElement(\"td\",null,book.bookName),React.createElement(\"td\",{className:\"overdue-days\"},book.daysOverdue),React.createElement(\"td\",{className:\"potential-fine\"},\"\\u20B9\",(Math.max(0,book.daysOverdue-1)*10).toFixed(2)),React.createElement(\"td\",null,new Date(book.deadline).toLocaleDateString()));}))))),selectedStudent&&React.createElement(\"div\",{className:\"payment-modal\",style:{position:'fixed',top:0,left:0,width:'100%',height:'100%',backgroundColor:'rgba(0,0,0,0.5)',display:'flex',justifyContent:'center',alignItems:'center',zIndex:1000}},React.createElement(\"div\",{className:\"modal-content\",style:{backgroundColor:'white',padding:'20px',borderRadius:'10px',maxWidth:'600px',width:'90%',maxHeight:'80vh',overflow:'auto'}},React.createElement(\"div\",{style:{display:'flex',justifyContent:'space-between',alignItems:'center',marginBottom:'20px'}},React.createElement(\"h3\",null,\"Process Payment\"),React.createElement(\"button\",{onClick:function onClick(){return _this2.setState({selectedStudent:null,paymentAmount:''});},style:{background:'none',border:'none',fontSize:'24px',cursor:'pointer',color:'#999'}},\"\\xD7\")),React.createElement(\"div\",{className:\"payment-details\"},React.createElement(\"p\",null,React.createElement(\"strong\",null,\"Student:\"),\" \",selectedStudent.name),React.createElement(\"p\",null,React.createElement(\"strong\",null,\"Current Fine:\"),\" \\u20B9\",(parseFloat(selectedStudent.fine)||0).toFixed(2)),React.createElement(\"div\",{className:\"payment-input\"},React.createElement(\"label\",null,\"Payment Amount:\"),React.createElement(\"input\",{type:\"number\",step:\"0.01\",max:parseFloat(selectedStudent.fine)||0,value:paymentAmount,onChange:function onChange(e){return _this2.setState({paymentAmount:e.target.value});},placeholder:\"Enter amount\"})),React.createElement(\"div\",{className:\"payment-methods\"},React.createElement(\"h4\",null,\"Payment Options\"),React.createElement(\"div\",{className:\"upi-payment\",style:{marginBottom:'20px',padding:'15px',border:'1px solid #ddd',borderRadius:'8px'}},React.createElement(\"h5\",null,\"UPI Payment\"),React.createElement(\"div\",{className:\"upi-options\",style:{display:'flex',gap:'20px',flexWrap:'wrap'}},React.createElement(\"div\",{className:\"upi-qr\",style:{textAlign:'center'}},React.createElement(\"p\",null,\"Scan QR Code:\"),React.createElement(\"img\",{src:\"https://api.qrserver.com/v1/create-qr-code/?size=150x150&data=upi://pay?pa=8275152241@ibl&pn=MIT%20Library&am=\".concat(paymentAmount||0,\"&cu=INR&tn=Fine%20Payment%20Student%20\").concat(selectedStudent.id),alt:\"UPI QR Code\",style:{border:'1px solid #ddd',padding:'10px'},onError:function onError(e){e.target.src='data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTUwIiBoZWlnaHQ9IjE1MCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSIjZGRkIi8+PHRleHQgeD0iNTAlIiB5PSI1MCUiIGZvbnQtZmFtaWx5PSJBcmlhbCIgZm9udC1zaXplPSIxNCIgZmlsbD0iIzk5OSIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZHk9Ii4zZW0iPkVycm9yIExvYWRpbmcgUVI8L3RleHQ+PC9zdmc+';}})),React.createElement(\"div\",{className:\"upi-links\",style:{flex:1,minWidth:'200px'}},React.createElement(\"p\",null,\"Or click to pay:\"),React.createElement(\"div\",{className:\"upi-apps\",style:{display:'flex',flexDirection:'column',gap:'10px'}},React.createElement(\"a\",{href:\"upi://pay?pa=8275152241@ibl&pn=MIT%20Library&am=\".concat(paymentAmount||0,\"&cu=INR&tn=Fine%20Payment%20Student%20\").concat(selectedStudent.id),className:\"upi-link paytm\",style:{margin:'5px',padding:'8px 15px',backgroundColor:'#00BAF2',color:'white',textDecoration:'none',borderRadius:'5px',display:'inline-block'},onClick:function onClick(e){if(!paymentAmount||paymentAmount<=0){e.preventDefault();alert('Please enter a valid payment amount');}}},\"PayTM\"),React.createElement(\"a\",{href:\"upi://pay?pa=8275152241@ibl&pn=MIT%20Library&am=\".concat(paymentAmount||0,\"&cu=INR&tn=Fine%20Payment%20Student%20\").concat(selectedStudent.id),className:\"upi-link gpay\",style:{margin:'5px',padding:'8px 15px',backgroundColor:'#4285F4',color:'white',textDecoration:'none',borderRadius:'5px',display:'inline-block'},onClick:function onClick(e){if(!paymentAmount||paymentAmount<=0){e.preventDefault();alert('Please enter a valid payment amount');}}},\"Google Pay\"),React.createElement(\"a\",{href:\"upi://pay?pa=8275152241@ibl&pn=MIT%20Library&am=\".concat(paymentAmount||0,\"&cu=INR&tn=Fine%20Payment%20Student%20\").concat(selectedStudent.id),className:\"upi-link phonepe\",style:{margin:'5px',padding:'8px 15px',backgroundColor:'#5F259F',color:'white',textDecoration:'none',borderRadius:'5px',display:'inline-block'},onClick:function onClick(e){if(!paymentAmount||paymentAmount<=0){e.preventDefault();alert('Please enter a valid payment amount');}}},\"PhonePe\")))),React.createElement(\"div\",{className:\"upi-details\",style:{marginTop:'15px',padding:'10px',backgroundColor:'#f8f9fa',borderRadius:'5px'}},React.createElement(\"p\",null,React.createElement(\"strong\",null,\"UPI ID:\"),\" 8275152241@ibl\"),React.createElement(\"p\",null,React.createElement(\"strong\",null,\"Amount:\"),\" \\u20B9\",paymentAmount||0),React.createElement(\"p\",null,React.createElement(\"strong\",null,\"Reference:\"),\" Student ID \",selectedStudent.id,\" - \",selectedStudent.name))),React.createElement(\"div\",{className:\"manual-payment\",style:{marginTop:'20px',borderTop:'1px solid #ddd',paddingTop:'15px'}},React.createElement(\"h5\",null,\"Manual Payment Confirmation\"),React.createElement(\"p\",{style:{fontSize:'14px',color:'#666'}},\"After making the UPI payment, click below to mark as paid:\"),React.createElement(\"div\",{className:\"payment-actions\"},React.createElement(\"button\",{className:\"process-btn\",onClick:function onClick(){return _this2.payFine(selectedStudent.id,selectedStudent.name,parseFloat(selectedStudent.fine)||0);},style:{backgroundColor:'#28a745',color:'white',padding:'10px 20px',border:'none',borderRadius:'5px',marginRight:'10px',cursor:'pointer'}},\"Mark as Paid\"),React.createElement(\"button\",{className:\"cancel-btn\",onClick:function onClick(){return _this2.setState({selectedStudent:null,paymentAmount:''});},style:{backgroundColor:'#6c757d',color:'white',padding:'10px 20px',border:'none',borderRadius:'5px',cursor:'pointer'}},\"Cancel\"))))))));}}]);return FineManagement;}(Component);export default FineManagement;","map":{"version":3,"sources":["/Users/sanketbanate/Desktop/Project/Library-Management-System/frontend/src/components/FineManagement/FineManagement.js"],"names":["React","Component","axios","FineManagement","props","fetchFineData","setState","loading","Promise","all","get","then","finesRes","overdueRes","studentsWithFines","data","overdueBooks","catch","error","console","payFine","studentId","studentName","currentFine","amount","parseFloat","state","paymentAmount","alert","window","confirm","post","response","selectedStudent","length","map","student","id","name","fine","toFixed","toString","book","index","bookName","daysOverdue","Math","max","Date","deadline","toLocaleDateString","position","top","left","width","height","backgroundColor","display","justifyContent","alignItems","zIndex","padding","borderRadius","maxWidth","maxHeight","overflow","marginBottom","background","border","fontSize","cursor","color","e","target","value","gap","flexWrap","textAlign","src","flex","minWidth","flexDirection","margin","textDecoration","preventDefault","marginTop","borderTop","paddingTop","marginRight"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport axios from 'axios';\nimport './FineManagement.css';\n\nclass FineManagement extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            studentsWithFines: [],\n            overdueBooks: [],\n            paymentAmount: '',\n            selectedStudent: null,\n            loading: false\n        };\n    }\n\n    componentDidMount() {\n        this.fetchFineData();\n    }\n\n    fetchFineData = () => {\n        this.setState({ loading: true });\n        Promise.all([\n            axios.get('/api/studentsWithFines'),\n            axios.get('/api/overdueBooks')\n        ])\n        .then(([finesRes, overdueRes]) => {\n            this.setState({\n                studentsWithFines: finesRes.data,\n                overdueBooks: overdueRes.data,\n                loading: false\n            });\n        })\n        .catch(error => {\n            console.error('Error fetching fine data:', error);\n            this.setState({ loading: false });\n        });\n    }\n\n    payFine = (studentId, studentName, currentFine) => {\n        const amount = parseFloat(this.state.paymentAmount);\n        if (!amount || amount <= 0 || amount > currentFine) {\n            alert('Please enter a valid payment amount');\n            return;\n        }\n\n        if (window.confirm(`Process payment of ₹${amount} for ${studentName}?`)) {\n            axios.post('/api/payFine', { studentId, amount })\n                .then(response => {\n                    alert('Payment processed successfully!');\n                    this.setState({ paymentAmount: '', selectedStudent: null });\n                    this.fetchFineData();\n                })\n                .catch(error => {\n                    console.error('Error processing payment:', error);\n                    alert('Failed to process payment');\n                });\n        }\n    }\n\n    render() {\n        const { studentsWithFines, overdueBooks, paymentAmount, selectedStudent, loading } = this.state;\n\n        return (\n            <div className=\"fine-management\">\n                <h2>Fine Management</h2>\n\n                {loading && <div className=\"loading\">Loading...</div>}\n\n                <div className=\"fine-sections\">\n                    <div className=\"section\">\n                        <h3>Students with Outstanding Fines</h3>\n                        {studentsWithFines.length === 0 ? (\n                            <p className=\"no-data\">No outstanding fines</p>\n                        ) : (\n                            <table>\n                                <thead>\n                                    <tr>\n                                        <th>Student ID</th>\n                                        <th>Student Name</th>\n                                        <th>Fine Amount</th>\n                                        <th>Actions</th>\n                                    </tr>\n                                </thead>\n                                <tbody>\n                                    {studentsWithFines.map(student => (\n                                        <tr key={student.id}>\n                                            <td>{student.id}</td>\n                                            <td>{student.name}</td>\n                                            <td className=\"fine-amount\">₹{(parseFloat(student.fine) || 0).toFixed(2)}</td>\n                                            <td>\n                                                <button \n                                                    className=\"pay-btn\"\n                                                    onClick={() => this.setState({ \n                                                        selectedStudent: student,\n                                                        paymentAmount: (parseFloat(student.fine) || 0).toString()\n                                                    })}\n                                                >\n                                                    Pay Fine\n                                                </button>\n                                            </td>\n                                        </tr>\n                                    ))}\n                                </tbody>\n                            </table>\n                        )}\n                    </div>\n\n                    <div className=\"section\">\n                        <h3>Overdue Books (Generating Fines)</h3>\n                        {overdueBooks.length === 0 ? (\n                            <p className=\"no-data\">No overdue books</p>\n                        ) : (\n                            <table>\n                                <thead>\n                                    <tr>\n                                        <th>Student</th>\n                                        <th>Book</th>\n                                        <th>Days Overdue</th>\n                                        <th>Potential Fine</th>\n                                        <th>Deadline</th>\n                                    </tr>\n                                </thead>\n                                <tbody>\n                                    {overdueBooks.map((book, index) => (\n                                        <tr key={index}>\n                                            <td>{book.studentName}</td>\n                                            <td>{book.bookName}</td>\n                                            <td className=\"overdue-days\">{book.daysOverdue}</td>\n                                            <td className=\"potential-fine\">\n                                                ₹{(Math.max(0, book.daysOverdue - 1) * 10).toFixed(2)}\n                                            </td>\n                                            <td>{new Date(book.deadline).toLocaleDateString()}</td>\n                                        </tr>\n                                    ))}\n                                </tbody>\n                            </table>\n                        )}\n                    </div>\n                </div>\n\n                {selectedStudent && (\n                    <div className=\"payment-modal\" style={{\n                        position: 'fixed',\n                        top: 0,\n                        left: 0,\n                        width: '100%',\n                        height: '100%',\n                        backgroundColor: 'rgba(0,0,0,0.5)',\n                        display: 'flex',\n                        justifyContent: 'center',\n                        alignItems: 'center',\n                        zIndex: 1000\n                    }}>\n                        <div className=\"modal-content\" style={{\n                            backgroundColor: 'white',\n                            padding: '20px',\n                            borderRadius: '10px',\n                            maxWidth: '600px',\n                            width: '90%',\n                            maxHeight: '80vh',\n                            overflow: 'auto'\n                        }}>\n                            <div style={{display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '20px'}}>\n                                <h3>Process Payment</h3>\n                                <button \n                                    onClick={() => this.setState({ selectedStudent: null, paymentAmount: '' })}\n                                    style={{\n                                        background: 'none',\n                                        border: 'none',\n                                        fontSize: '24px',\n                                        cursor: 'pointer',\n                                        color: '#999'\n                                    }}\n                                >\n                                    ×\n                                </button>\n                            </div>\n                            <div className=\"payment-details\">\n                                <p><strong>Student:</strong> {selectedStudent.name}</p>\n                                <p><strong>Current Fine:</strong> ₹{(parseFloat(selectedStudent.fine) || 0).toFixed(2)}</p>\n                                <div className=\"payment-input\">\n                                    <label>Payment Amount:</label>\n                                    <input\n                                        type=\"number\"\n                                        step=\"0.01\"\n                                        max={parseFloat(selectedStudent.fine) || 0}\n                                        value={paymentAmount}\n                                        onChange={(e) => this.setState({ paymentAmount: e.target.value })}\n                                        placeholder=\"Enter amount\"\n                                    />\n                                </div>\n                                <div className=\"payment-methods\">\n                                    <h4>Payment Options</h4>\n                                    \n                                    {/* UPI Payment Section */}\n                                    <div className=\"upi-payment\" style={{marginBottom: '20px', padding: '15px', border: '1px solid #ddd', borderRadius: '8px'}}>\n                                        <h5>UPI Payment</h5>\n                                        <div className=\"upi-options\" style={{display: 'flex', gap: '20px', flexWrap: 'wrap'}}>\n                                            <div className=\"upi-qr\" style={{textAlign: 'center'}}>\n                                                <p>Scan QR Code:</p>\n                                                <img \n                                                    src={`https://api.qrserver.com/v1/create-qr-code/?size=150x150&data=upi://pay?pa=8275152241@ibl&pn=MIT%20Library&am=${paymentAmount || 0}&cu=INR&tn=Fine%20Payment%20Student%20${selectedStudent.id}`}\n                                                    alt=\"UPI QR Code\"\n                                                    style={{border: '1px solid #ddd', padding: '10px'}}\n                                                    onError={(e) => {\n                                                        e.target.src = 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTUwIiBoZWlnaHQ9IjE1MCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSIjZGRkIi8+PHRleHQgeD0iNTAlIiB5PSI1MCUiIGZvbnQtZmFtaWx5PSJBcmlhbCIgZm9udC1zaXplPSIxNCIgZmlsbD0iIzk5OSIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZHk9Ii4zZW0iPkVycm9yIExvYWRpbmcgUVI8L3RleHQ+PC9zdmc+';\n                                                    }}\n                                                />\n                                            </div>\n                                            <div className=\"upi-links\" style={{flex: 1, minWidth: '200px'}}>\n                                                <p>Or click to pay:</p>\n                                                <div className=\"upi-apps\" style={{display: 'flex', flexDirection: 'column', gap: '10px'}}>\n                                                    <a \n                                                        href={`upi://pay?pa=8275152241@ibl&pn=MIT%20Library&am=${paymentAmount || 0}&cu=INR&tn=Fine%20Payment%20Student%20${selectedStudent.id}`}\n                                                        className=\"upi-link paytm\"\n                                                        style={{margin: '5px', padding: '8px 15px', backgroundColor: '#00BAF2', color: 'white', textDecoration: 'none', borderRadius: '5px', display: 'inline-block'}}\n                                                        onClick={(e) => {\n                                                            if (!paymentAmount || paymentAmount <= 0) {\n                                                                e.preventDefault();\n                                                                alert('Please enter a valid payment amount');\n                                                            }\n                                                        }}\n                                                    >\n                                                        PayTM\n                                                    </a>\n                                                    <a \n                                                        href={`upi://pay?pa=8275152241@ibl&pn=MIT%20Library&am=${paymentAmount || 0}&cu=INR&tn=Fine%20Payment%20Student%20${selectedStudent.id}`}\n                                                        className=\"upi-link gpay\"\n                                                        style={{margin: '5px', padding: '8px 15px', backgroundColor: '#4285F4', color: 'white', textDecoration: 'none', borderRadius: '5px', display: 'inline-block'}}\n                                                        onClick={(e) => {\n                                                            if (!paymentAmount || paymentAmount <= 0) {\n                                                                e.preventDefault();\n                                                                alert('Please enter a valid payment amount');\n                                                            }\n                                                        }}\n                                                    >\n                                                        Google Pay\n                                                    </a>\n                                                    <a \n                                                        href={`upi://pay?pa=8275152241@ibl&pn=MIT%20Library&am=${paymentAmount || 0}&cu=INR&tn=Fine%20Payment%20Student%20${selectedStudent.id}`}\n                                                        className=\"upi-link phonepe\"\n                                                        style={{margin: '5px', padding: '8px 15px', backgroundColor: '#5F259F', color: 'white', textDecoration: 'none', borderRadius: '5px', display: 'inline-block'}}\n                                                        onClick={(e) => {\n                                                            if (!paymentAmount || paymentAmount <= 0) {\n                                                                e.preventDefault();\n                                                                alert('Please enter a valid payment amount');\n                                                            }\n                                                        }}\n                                                    >\n                                                        PhonePe\n                                                    </a>\n                                                </div>\n                                            </div>\n                                        </div>\n                                        <div className=\"upi-details\" style={{marginTop: '15px', padding: '10px', backgroundColor: '#f8f9fa', borderRadius: '5px'}}>\n                                            <p><strong>UPI ID:</strong> 8275152241@ibl</p>\n                                            <p><strong>Amount:</strong> ₹{paymentAmount || 0}</p>\n                                            <p><strong>Reference:</strong> Student ID {selectedStudent.id} - {selectedStudent.name}</p>\n                                        </div>\n                                    </div>\n                                    \n                                    <div className=\"manual-payment\" style={{marginTop: '20px', borderTop: '1px solid #ddd', paddingTop: '15px'}}>\n                                        <h5>Manual Payment Confirmation</h5>\n                                        <p style={{fontSize: '14px', color: '#666'}}>After making the UPI payment, click below to mark as paid:</p>\n                                        <div className=\"payment-actions\">\n                                            <button \n                                                className=\"process-btn\"\n                                                onClick={() => this.payFine(selectedStudent.id, selectedStudent.name, parseFloat(selectedStudent.fine) || 0)}\n                                                style={{backgroundColor: '#28a745', color: 'white', padding: '10px 20px', border: 'none', borderRadius: '5px', marginRight: '10px', cursor: 'pointer'}}\n                                            >\n                                                Mark as Paid\n                                            </button>\n                                            <button \n                                                className=\"cancel-btn\"\n                                                onClick={() => this.setState({ selectedStudent: null, paymentAmount: '' })}\n                                                style={{backgroundColor: '#6c757d', color: 'white', padding: '10px 20px', border: 'none', borderRadius: '5px', cursor: 'pointer'}}\n                                            >\n                                                Cancel\n                                            </button>\n                                        </div>\n                                    </div>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                )}\n            </div>\n        );\n    }\n}\n\nexport default FineManagement;"]},"metadata":{},"sourceType":"module"}