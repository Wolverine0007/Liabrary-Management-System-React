{"ast":null,"code":"import _slicedToArray from \"/Users/sanketbanate/Desktop/Project/Library-Management-System/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"/Users/sanketbanate/Desktop/Project/Library-Management-System/frontend/src/components/Return/Return.js\";\nimport React, { useState } from 'react';\nimport axios from 'axios';\nimport config from '../../config';\nimport { Container, Typography, TextField, Button, Card, CardContent, Grid, Table, TableBody, TableCell, TableHead, TableRow } from '@material-ui/core';\nimport './Return.css';\n\nfunction Return() {\n  const _useState = useState(''),\n        _useState2 = _slicedToArray(_useState, 2),\n        searchTerm = _useState2[0],\n        setSearchTerm = _useState2[1];\n\n  const _useState3 = useState(null),\n        _useState4 = _slicedToArray(_useState3, 2),\n        selectedStudent = _useState4[0],\n        setSelectedStudent = _useState4[1];\n\n  const _useState5 = useState([]),\n        _useState6 = _slicedToArray(_useState5, 2),\n        issuedBooks = _useState6[0],\n        setIssuedBooks = _useState6[1];\n\n  const _useState7 = useState(''),\n        _useState8 = _slicedToArray(_useState7, 2),\n        message = _useState8[0],\n        setMessage = _useState8[1];\n\n  const _useState9 = useState(''),\n        _useState10 = _slicedToArray(_useState9, 2),\n        fineInfo = _useState10[0],\n        setFineInfo = _useState10[1];\n\n  const searchStudent = async e => {\n    e.preventDefault();\n\n    try {\n      // Search by ID first, then by name if ID search fails\n      let response;\n\n      if (!isNaN(searchTerm)) {\n        response = await axios.get(`${config.API_BASE_URL}/api/getIssues/${searchTerm}`);\n\n        if (response.data.length > 0) {\n          setSelectedStudent({\n            id: searchTerm,\n            name: response.data[0].sname\n          });\n          setIssuedBooks(response.data);\n          setMessage('');\n        } else {\n          setMessage('No books found for this student ID.');\n          setSelectedStudent(null);\n          setIssuedBooks([]);\n        }\n      } else {\n        // Search by name - we'll need to add this endpoint\n        const studentsResponse = await axios.get(`${config.API_BASE_URL}/api/searchStudentByName/${searchTerm}`);\n\n        if (studentsResponse.data.length > 0) {\n          const student = studentsResponse.data[0];\n          const booksResponse = await axios.get(`${config.API_BASE_URL}/api/getIssues/${student.id}`);\n          setSelectedStudent(student);\n          setIssuedBooks(booksResponse.data);\n          setMessage('');\n        } else {\n          setMessage('No student found with this name.');\n          setSelectedStudent(null);\n          setIssuedBooks([]);\n        }\n      }\n    } catch (error) {\n      setMessage('Error searching for student. Please try again.');\n      console.error('Error searching student:', error);\n    }\n  };\n\n  const calculateFine = deadline => {\n    const deadlineDate = new Date(deadline);\n    const currentDate = new Date();\n    const timeDiff = currentDate - deadlineDate;\n    const daysDiff = Math.ceil(timeDiff / (1000 * 60 * 60 * 24));\n    return daysDiff > 0 ? daysDiff * 10 : 0;\n  };\n\n  const handleReturnBook = async (bookId, bookName, deadline) => {\n    try {\n      const fine = calculateFine(deadline);\n      await axios.post(`${config.API_BASE_URL}/api/return`, {\n        sid: selectedStudent.id,\n        id: bookId\n      });\n\n      if (fine > 0) {\n        setFineInfo(`Book \"${bookName}\" returned successfully! Fine applied: ₹${fine}`);\n      } else {\n        setFineInfo(`Book \"${bookName}\" returned successfully! No fine applied.`);\n      } // Refresh the issued books list\n\n\n      const response = await axios.get(`${config.API_BASE_URL}/api/getIssues/${selectedStudent.id}`);\n      setIssuedBooks(response.data);\n    } catch (error) {\n      setMessage('Error returning book. Please try again.');\n      console.error('Error returning book:', error);\n    }\n  };\n\n  const resetSearch = () => {\n    setSearchTerm('');\n    setSelectedStudent(null);\n    setIssuedBooks([]);\n    setMessage('');\n    setFineInfo('');\n  };\n\n  return React.createElement(Container, {\n    className: \"return-container\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 91\n    },\n    __self: this\n  }, React.createElement(Typography, {\n    variant: \"h4\",\n    className: \"return-title\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 92\n    },\n    __self: this\n  }, \"Return Books\"), React.createElement(Card, {\n    className: \"return-card\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 96\n    },\n    __self: this\n  }, React.createElement(CardContent, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 97\n    },\n    __self: this\n  }, React.createElement(Typography, {\n    variant: \"h6\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 98\n    },\n    __self: this\n  }, \"Search Student\"), React.createElement(\"form\", {\n    onSubmit: searchStudent,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 99\n    },\n    __self: this\n  }, React.createElement(TextField, {\n    label: \"Student ID or Name\",\n    variant: \"outlined\",\n    fullWidth: true,\n    margin: \"normal\",\n    value: searchTerm,\n    onChange: e => setSearchTerm(e.target.value),\n    placeholder: \"Enter student ID (number) or student name\",\n    required: true,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 100\n    },\n    __self: this\n  }), React.createElement(Grid, {\n    container: true,\n    spacing: 2,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 110\n    },\n    __self: this\n  }, React.createElement(Grid, {\n    item: true,\n    xs: 6,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 111\n    },\n    __self: this\n  }, React.createElement(Button, {\n    type: \"submit\",\n    variant: \"contained\",\n    color: \"primary\",\n    fullWidth: true,\n    className: \"search-button\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 112\n    },\n    __self: this\n  }, \"Search Student\")), React.createElement(Grid, {\n    item: true,\n    xs: 6,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 122\n    },\n    __self: this\n  }, React.createElement(Button, {\n    variant: \"outlined\",\n    color: \"secondary\",\n    fullWidth: true,\n    onClick: resetSearch,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 123\n    },\n    __self: this\n  }, \"Reset\")))))), selectedStudent && React.createElement(Card, {\n    className: \"student-info-card\",\n    style: {\n      marginTop: '20px'\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 138\n    },\n    __self: this\n  }, React.createElement(CardContent, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 139\n    },\n    __self: this\n  }, React.createElement(Typography, {\n    variant: \"h6\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 140\n    },\n    __self: this\n  }, \"Student: \", selectedStudent.name, \" (ID: \", selectedStudent.id, \")\"), issuedBooks.length > 0 ? React.createElement(React.Fragment, null, React.createElement(Typography, {\n    variant: \"subtitle1\",\n    style: {\n      marginTop: '15px'\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 146\n    },\n    __self: this\n  }, \"Books Currently Issued:\"), React.createElement(Table, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 149\n    },\n    __self: this\n  }, React.createElement(TableHead, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 150\n    },\n    __self: this\n  }, React.createElement(TableRow, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 151\n    },\n    __self: this\n  }, React.createElement(TableCell, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 152\n    },\n    __self: this\n  }, \"Book Name\"), React.createElement(TableCell, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 153\n    },\n    __self: this\n  }, \"Author\"), React.createElement(TableCell, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 154\n    },\n    __self: this\n  }, \"Issue Date\"), React.createElement(TableCell, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 155\n    },\n    __self: this\n  }, \"Deadline\"), React.createElement(TableCell, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 156\n    },\n    __self: this\n  }, \"Fine (\\u20B9)\"), React.createElement(TableCell, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 157\n    },\n    __self: this\n  }, \"Action\"))), React.createElement(TableBody, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 160\n    },\n    __self: this\n  }, issuedBooks.map((book, index) => {\n    const fine = calculateFine(book.deadline);\n    const isOverdue = fine > 0;\n    return React.createElement(TableRow, {\n      key: index,\n      style: {\n        backgroundColor: isOverdue ? '#ffebee' : 'inherit'\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 165\n      },\n      __self: this\n    }, React.createElement(TableCell, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 166\n      },\n      __self: this\n    }, book.name), React.createElement(TableCell, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 167\n      },\n      __self: this\n    }, book.author), React.createElement(TableCell, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 168\n      },\n      __self: this\n    }, new Date(book.date).toLocaleDateString()), React.createElement(TableCell, {\n      style: {\n        color: isOverdue ? 'red' : 'inherit'\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 169\n      },\n      __self: this\n    }, new Date(book.deadline).toLocaleDateString()), React.createElement(TableCell, {\n      style: {\n        color: isOverdue ? 'red' : 'green'\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 172\n      },\n      __self: this\n    }, \"\\u20B9\", fine), React.createElement(TableCell, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 175\n      },\n      __self: this\n    }, React.createElement(Button, {\n      variant: \"contained\",\n      color: \"primary\",\n      size: \"small\",\n      onClick: () => handleReturnBook(book.id, book.name, book.deadline),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 176\n      },\n      __self: this\n    }, \"Return\")));\n  })))) : React.createElement(Typography, {\n    variant: \"body1\",\n    style: {\n      marginTop: '15px',\n      color: 'green'\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 192\n    },\n    __self: this\n  }, \"No books currently issued to this student.\"))), message && React.createElement(Typography, {\n    variant: \"body1\",\n    className: message.includes('Error') ? 'error-message' : 'success-message',\n    style: {\n      marginTop: '15px'\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 201\n    },\n    __self: this\n  }, message), fineInfo && React.createElement(Typography, {\n    variant: \"body1\",\n    style: {\n      marginTop: '15px',\n      color: 'green',\n      fontWeight: 'bold'\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 211\n    },\n    __self: this\n  }, fineInfo));\n}\n\nexport default Return;","map":{"version":3,"sources":["/Users/sanketbanate/Desktop/Project/Library-Management-System/frontend/src/components/Return/Return.js"],"names":["React","useState","axios","config","Container","Typography","TextField","Button","Card","CardContent","Grid","Table","TableBody","TableCell","TableHead","TableRow","Return","searchTerm","setSearchTerm","selectedStudent","setSelectedStudent","issuedBooks","setIssuedBooks","message","setMessage","fineInfo","setFineInfo","searchStudent","e","preventDefault","response","isNaN","get","API_BASE_URL","data","length","id","name","sname","studentsResponse","student","booksResponse","error","console","calculateFine","deadline","deadlineDate","Date","currentDate","timeDiff","daysDiff","Math","ceil","handleReturnBook","bookId","bookName","fine","post","sid","resetSearch","target","value","marginTop","map","book","index","isOverdue","backgroundColor","author","date","toLocaleDateString","color","includes","fontWeight"],"mappings":"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","sourcesContent":["import React, { useState } from 'react';\nimport axios from 'axios';\nimport config from '../../config';\nimport { Container, Typography, TextField, Button, Card, CardContent, Grid, Table, TableBody, TableCell, TableHead, TableRow } from '@material-ui/core';\nimport './Return.css';\n\nfunction Return() {\n    const [searchTerm, setSearchTerm] = useState('');\n    const [selectedStudent, setSelectedStudent] = useState(null);\n    const [issuedBooks, setIssuedBooks] = useState([]);\n    const [message, setMessage] = useState('');\n    const [fineInfo, setFineInfo] = useState('');\n\n    const searchStudent = async (e) => {\n        e.preventDefault();\n        try {\n            // Search by ID first, then by name if ID search fails\n            let response;\n            if (!isNaN(searchTerm)) {\n                response = await axios.get(`${config.API_BASE_URL}/api/getIssues/${searchTerm}`);\n                if (response.data.length > 0) {\n                    setSelectedStudent({ id: searchTerm, name: response.data[0].sname });\n                    setIssuedBooks(response.data);\n                    setMessage('');\n                } else {\n                    setMessage('No books found for this student ID.');\n                    setSelectedStudent(null);\n                    setIssuedBooks([]);\n                }\n            } else {\n                // Search by name - we'll need to add this endpoint\n                const studentsResponse = await axios.get(`${config.API_BASE_URL}/api/searchStudentByName/${searchTerm}`);\n                if (studentsResponse.data.length > 0) {\n                    const student = studentsResponse.data[0];\n                    const booksResponse = await axios.get(`${config.API_BASE_URL}/api/getIssues/${student.id}`);\n                    setSelectedStudent(student);\n                    setIssuedBooks(booksResponse.data);\n                    setMessage('');\n                } else {\n                    setMessage('No student found with this name.');\n                    setSelectedStudent(null);\n                    setIssuedBooks([]);\n                }\n            }\n        } catch (error) {\n            setMessage('Error searching for student. Please try again.');\n            console.error('Error searching student:', error);\n        }\n    };\n\n    const calculateFine = (deadline) => {\n        const deadlineDate = new Date(deadline);\n        const currentDate = new Date();\n        const timeDiff = currentDate - deadlineDate;\n        const daysDiff = Math.ceil(timeDiff / (1000 * 60 * 60 * 24));\n        return daysDiff > 0 ? daysDiff * 10 : 0;\n    };\n\n    const handleReturnBook = async (bookId, bookName, deadline) => {\n        try {\n            const fine = calculateFine(deadline);\n            await axios.post(`${config.API_BASE_URL}/api/return`, {\n                sid: selectedStudent.id,\n                id: bookId\n            });\n            \n            if (fine > 0) {\n                setFineInfo(`Book \"${bookName}\" returned successfully! Fine applied: ₹${fine}`);\n            } else {\n                setFineInfo(`Book \"${bookName}\" returned successfully! No fine applied.`);\n            }\n            \n            // Refresh the issued books list\n            const response = await axios.get(`${config.API_BASE_URL}/api/getIssues/${selectedStudent.id}`);\n            setIssuedBooks(response.data);\n        } catch (error) {\n            setMessage('Error returning book. Please try again.');\n            console.error('Error returning book:', error);\n        }\n    };\n\n    const resetSearch = () => {\n        setSearchTerm('');\n        setSelectedStudent(null);\n        setIssuedBooks([]);\n        setMessage('');\n        setFineInfo('');\n    };\n\n    return (\n        <Container className=\"return-container\">\n            <Typography variant=\"h4\" className=\"return-title\">\n                Return Books\n            </Typography>\n            \n            <Card className=\"return-card\">\n                <CardContent>\n                    <Typography variant=\"h6\">Search Student</Typography>\n                    <form onSubmit={searchStudent}>\n                        <TextField\n                            label=\"Student ID or Name\"\n                            variant=\"outlined\"\n                            fullWidth\n                            margin=\"normal\"\n                            value={searchTerm}\n                            onChange={(e) => setSearchTerm(e.target.value)}\n                            placeholder=\"Enter student ID (number) or student name\"\n                            required\n                        />\n                        <Grid container spacing={2}>\n                            <Grid item xs={6}>\n                                <Button\n                                    type=\"submit\"\n                                    variant=\"contained\"\n                                    color=\"primary\"\n                                    fullWidth\n                                    className=\"search-button\"\n                                >\n                                    Search Student\n                                </Button>\n                            </Grid>\n                            <Grid item xs={6}>\n                                <Button\n                                    variant=\"outlined\"\n                                    color=\"secondary\"\n                                    fullWidth\n                                    onClick={resetSearch}\n                                >\n                                    Reset\n                                </Button>\n                            </Grid>\n                        </Grid>\n                    </form>\n                </CardContent>\n            </Card>\n\n            {selectedStudent && (\n                <Card className=\"student-info-card\" style={{marginTop: '20px'}}>\n                    <CardContent>\n                        <Typography variant=\"h6\">\n                            Student: {selectedStudent.name} (ID: {selectedStudent.id})\n                        </Typography>\n                        \n                        {issuedBooks.length > 0 ? (\n                            <>\n                                <Typography variant=\"subtitle1\" style={{marginTop: '15px'}}>\n                                    Books Currently Issued:\n                                </Typography>\n                                <Table>\n                                    <TableHead>\n                                        <TableRow>\n                                            <TableCell>Book Name</TableCell>\n                                            <TableCell>Author</TableCell>\n                                            <TableCell>Issue Date</TableCell>\n                                            <TableCell>Deadline</TableCell>\n                                            <TableCell>Fine (₹)</TableCell>\n                                            <TableCell>Action</TableCell>\n                                        </TableRow>\n                                    </TableHead>\n                                    <TableBody>\n                                        {issuedBooks.map((book, index) => {\n                                            const fine = calculateFine(book.deadline);\n                                            const isOverdue = fine > 0;\n                                            return (\n                                                <TableRow key={index} style={{backgroundColor: isOverdue ? '#ffebee' : 'inherit'}}>\n                                                    <TableCell>{book.name}</TableCell>\n                                                    <TableCell>{book.author}</TableCell>\n                                                    <TableCell>{new Date(book.date).toLocaleDateString()}</TableCell>\n                                                    <TableCell style={{color: isOverdue ? 'red' : 'inherit'}}>\n                                                        {new Date(book.deadline).toLocaleDateString()}\n                                                    </TableCell>\n                                                    <TableCell style={{color: isOverdue ? 'red' : 'green'}}>\n                                                        ₹{fine}\n                                                    </TableCell>\n                                                    <TableCell>\n                                                        <Button\n                                                            variant=\"contained\"\n                                                            color=\"primary\"\n                                                            size=\"small\"\n                                                            onClick={() => handleReturnBook(book.id, book.name, book.deadline)}\n                                                        >\n                                                            Return\n                                                        </Button>\n                                                    </TableCell>\n                                                </TableRow>\n                                            );\n                                        })}\n                                    </TableBody>\n                                </Table>\n                            </>\n                        ) : (\n                            <Typography variant=\"body1\" style={{marginTop: '15px', color: 'green'}}>\n                                No books currently issued to this student.\n                            </Typography>\n                        )}\n                    </CardContent>\n                </Card>\n            )}\n\n            {message && (\n                <Typography \n                    variant=\"body1\" \n                    className={message.includes('Error') ? 'error-message' : 'success-message'}\n                    style={{marginTop: '15px'}}\n                >\n                    {message}\n                </Typography>\n            )}\n            \n            {fineInfo && (\n                <Typography \n                    variant=\"body1\" \n                    style={{marginTop: '15px', color: 'green', fontWeight: 'bold'}}\n                >\n                    {fineInfo}\n                </Typography>\n            )}\n        </Container>\n    );\n}\n\nexport default Return;"]},"metadata":{},"sourceType":"module"}